<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Install istSOS package &mdash; istSOS v1 documentation</title>
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="istSOS v1 documentation" href="../index.html" />
    <link rel="up" title="Documentation" href="index.html" />
    <link rel="next" title="Testing" href="test.html" />
    <link rel="prev" title="How it works" href="how_it_work.html" /> 
  </head>
  <body>

<div style="background-color: white; text-align: center; padding: 10px 10px 15px 15px">
<a href="../index.html"><img src="../_static/istsos_small_logo.png" border="0" alt="istSOS" align="centre"/></a>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="test.html" title="Testing"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="how_it_work.html" title="How it works"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">home</a>|&nbsp;</li>
        <li><a href="index.html">documentation </a> |&nbsp;</li>
        <li><a href="../download/index.html">download </a> |&nbsp;</li>
        <li><a href="../tutorial/index.html">tutorial </a> |&nbsp;</li>
        <li><a href="../search.html">search</a>|&nbsp;</li>
        <li><a href="../licence/index.html">licence </a> |&nbsp;</li>

          <li><a href="index.html" accesskey="U">Documentation</a> &raquo;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="../index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="">Install istSOS package</a><ul>
<li><a class="reference external" href="#prerequirements">Prerequirements</a></li>
<li><a class="reference external" href="#software-installation">Software installation</a></li>
<li><a class="reference external" href="#database-setup">Database setup</a></li>
<li><a class="reference external" href="#configuring-the-service">Configuring the service</a></li>
<li><a class="reference external" href="#configure-istsos">Configure istSOS</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="how_it_work.html"
                                  title="previous chapter">How it works</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="test.html"
                                  title="next chapter">Testing</a></p>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="install-istsos-package">
<h1>Install istSOS package<a class="headerlink" href="#install-istsos-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="prerequirements">
<h2>Prerequirements<a class="headerlink" href="#prerequirements" title="Permalink to this headline">¶</a></h2>
<p>istSOS relies on <a class="reference external" href="http://www.python.org/">python</a> (&gt;= 2.6), PostgreSQL/PostGIS and Apache (with <a class="reference external" href="http://www.modpython.org">mod_python</a>).</p>
<p>In particular the follwoing python packages are required:</p>
<ul class="simple">
<li>psycopg2</li>
<li>isodate</li>
<li>gdal</li>
</ul>
</div>
<div class="section" id="software-installation">
<h2>Software installation<a class="headerlink" href="#software-installation" title="Permalink to this headline">¶</a></h2>
<p>Teoretically the installation of these package is authomatic by using easytools, but in some cases it fails due to package errors (compilation of GDAL, etc..).</p>
<p>Ubuntu users may found useful aading the ubuntuGIS repository and install required packages with synapthhic. In this case the workflow for Ubuntu users is:</p>
<ul class="simple">
<li>install setuptools (synapthic)</li>
<li>install python-dev (synapthic)</li>
<li>install numpy (synapthic)</li>
<li>install g++ (synapthic)</li>
<li>install GDAL (synapthic)</li>
<li>install psycopg2 (synapthic)</li>
<li>install mod_python (synapthic)</li>
<li>install postgresql-8.x-postgis (synapthic)</li>
<li>download istSOS</li>
<li>extract istSOS</li>
<li>cd into the extracted folder</li>
<li>run &#8220;sudo python setup.py install&#8221;</li>
</ul>
</div>
<div class="section" id="database-setup">
<h2>Database setup<a class="headerlink" href="#database-setup" title="Permalink to this headline">¶</a></h2>
<p>Create the database &#8220;sos&#8221; as postgres user:</p>
<div class="highlight-python"><pre>&gt; sudo su postgres
&gt; createdb sos</pre>
</div>
<p>Make your database a spatial database:</p>
<div class="highlight-python"><pre>#For PostGIS &lt; 1.5 (PostgreSQL = 8.3)
&gt; createlang plpgsql sos
&gt; psql -d sos -f /usr/share/postgresql-8.3-postgis/lwpostgis.sql
&gt; psql -d sos -f /usr/share/postgresql-8.3-postgis/spatial_ref_sys.sql

#For PostGIS &gt;= 1.5 (PostgreSQL = 8.4)
&gt; createlang plpgsql sos
&gt; psql -d sos -f /usr/share/postgresql/8.4/contrib/postgis.sql
&gt; psql -d sos -f /usr/share/postgresql/8.4/contrib/postgis_comments.sql
&gt; psql -d sos -f /usr/share/postgresql/8.4/contrib/spatial_ref_sys.sql</pre>
</div>
<p>Create the istsos schema:</p>
<div class="highlight-python"><pre>&gt; psql -d sos -f  ..../istSOS-1.0-rc1/DOCS/database/sos_schema.sql</pre>
</div>
</div>
<div class="section" id="configuring-the-service">
<h2>Configuring the service<a class="headerlink" href="#configuring-the-service" title="Permalink to this headline">¶</a></h2>
<p>Prepare your web folder for the service:</p>
<div class="highlight-python"><pre>&gt; sudo mkdir /var/www/sos
&gt; sudo mk dir /var/www/sos/sml
&gt; sudo chmod 777 -R /var/www/sos</pre>
</div>
<p>Copy required files:</p>
<div class="highlight-python"><pre>&gt; cp ..../istSOS-1.0-rc1/sos.py /var/www/sos/
&gt; cp -R ..../istSOS-1.0-rc1/DOCS/testPOST /var/www/sos/
&gt; cp -R ..../istSOS-1.0-rc1/istSOSconfig /var/www/sos/</pre>
</div>
<p>Configure Apache with mod_python:</p>
<div class="highlight-python"><pre>&gt; sudo gedit /etc/apache2/sites-enabled/000-default</pre>
</div>
<p>Edit the file by adding the following lines:</p>
<div class="highlight-python"><pre>&lt;Directory "/var/www/sos"&gt;
            AddHandler mod_python py
            DirectoryIndex sos.py
            PythonHandler mod_python.publisher
            PythonDebug On
            PythonPath "['/var/www/sos/istSOSconfig']+sys.path"
    &lt;/Directory&gt;</pre>
</div>
<p>Restart Apache:</p>
<div class="highlight-python"><pre>&gt; sudo /etc/init.d/apache2 restart</pre>
</div>
</div>
<div class="section" id="configure-istsos">
<h2>Configure istSOS<a class="headerlink" href="#configure-istsos" title="Permalink to this headline">¶</a></h2>
<p>istSOS has a configuration file named &#8220;sosConfig.py&#8221;. This file is commented to let the user understand the possible settings available.
The available sections are:</p>
<p>database properties:</p>
<div class="highlight-python"><pre>connection = {
               "user" : “postgres",
               "password" : “1234",
               "host" : "localhost",
               "dbname" : "sos",
               "port" : "5432"
              }
schema="istsos“</pre>
</div>
<p>authority and version of your institution:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#x- denote a not registered authority</span>
<span class="n">authority</span><span class="o">=</span><span class="s">&quot;x-ist&quot;</span>
<span class="n">version</span><span class="o">=</span><span class="s">&quot;&quot;</span>
</pre></div>
</div>
<p>database EPSG codes and output axis names:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">istSOSepsg</span> <span class="o">=</span> <span class="s">&quot;21781&quot;</span>
<span class="n">x_axis</span> <span class="o">=</span> <span class="s">&quot;easting&quot;</span>
<span class="n">y_axis</span> <span class="o">=</span> <span class="s">&quot;northing&quot;</span>
<span class="n">z_axis</span> <span class="o">=</span> <span class="s">&quot;altitude&quot;</span>
<span class="n">sos_allowedEPSG</span> <span class="o">=</span> <span class="p">[</span><span class="n">istSOSepsg</span><span class="p">,</span><span class="s">&quot;4326&quot;</span><span class="p">,</span><span class="s">&quot;900913&quot;</span><span class="p">]</span> <span class="c"># 900913 = Google projection</span>
</pre></div>
</div>
<p>SensorML folder path:</p>
<div class="highlight-python"><pre># n.b.: the folder must exist with the correct rigths (rw)
sensorMLpath = "/var/www/sos/sml/“</pre>
</div>
<p>http address of the service:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">serviceUrl</span> <span class="o">=</span> <span class="p">{</span>
              <span class="s">&quot;get&quot;</span> <span class="p">:</span> <span class="s">&quot;http://localhost/sos/istsos.py&quot;</span><span class="p">,</span>
              <span class="s">&quot;post&quot;</span> <span class="p">:</span> <span class="s">&quot;http://localhost/sos/istsos.py&quot;</span>
              <span class="p">}</span>
</pre></div>
</div>
<p>service identification:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">serviceIdentification</span><span class="o">=</span><span class="p">{</span>
                       <span class="s">&quot;title&quot;</span> <span class="p">:</span> <span class="s">&quot;IST Sensor Observation Service&quot;</span><span class="p">,</span>
                       <span class="s">&quot;abstract&quot;</span> <span class="p">:</span> <span class="s">&quot;hydro-meteorological monitoring network&quot;</span><span class="p">,</span>
                       <span class="s">&quot;keywords&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s">&quot;SOS&quot;</span><span class="p">,</span><span class="s">&quot;IST&quot;</span><span class="p">,</span><span class="s">&quot;SUPSI&quot;</span><span class="p">],</span>
                       <span class="s">&quot;fees&quot;</span> <span class="p">:</span> <span class="s">&quot;NONE&quot;</span><span class="p">,</span>
                       <span class="s">&quot;accessConstrains&quot;</span> <span class="p">:</span> <span class="s">&quot;NONE&quot;</span>
                       <span class="p">}</span>
</pre></div>
</div>
<p>service provider:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">serviceProvider</span><span class="o">=</span><span class="p">{</span>
                 <span class="s">&quot;providerName&quot;</span> <span class="p">:</span> <span class="s">&quot;Istituto Scienze della Terra&quot;</span><span class="p">,</span>
                 <span class="s">&quot;providerSite&quot;</span> <span class="p">:</span> <span class="s">&quot;http://istgeo.ist.supsi.ch&quot;</span><span class="p">,</span>
                 <span class="s">&quot;serviceContact&quot;</span> <span class="p">:</span> <span class="p">{</span>
                                     <span class="s">&quot;individualName&quot;</span> <span class="p">:</span> <span class="s">&quot;Massimiliano Cannata&quot;</span><span class="p">,</span>
                                     <span class="s">&quot;positionName&quot;</span> <span class="p">:</span> <span class="s">&quot;Geomatica&quot;</span><span class="p">,</span>
                                     <span class="s">&quot;contactInfo&quot;</span> <span class="p">:</span> <span class="p">{</span>
                                                      <span class="s">&quot;voice&quot;</span> <span class="p">:</span> <span class="s">&quot;6214&quot;</span><span class="p">,</span>
                                                      <span class="s">&quot;fax&quot;</span> <span class="p">:</span> <span class="s">&quot;6200&quot;</span><span class="p">,</span>
                                                      <span class="s">&quot;deliveryPoint&quot;</span> <span class="p">:</span> <span class="s">&quot;Via Trevano&quot;</span><span class="p">,</span>
                                                      <span class="s">&quot;city&quot;</span> <span class="p">:</span> <span class="s">&quot;Canobbio&quot;</span><span class="p">,</span>
                                                      <span class="s">&quot;administrativeArea&quot;</span> <span class="p">:</span> <span class="s">&quot;Ticino&quot;</span><span class="p">,</span>
                                                      <span class="s">&quot;postalCode&quot;</span> <span class="p">:</span> <span class="s">&quot;6952&quot;</span><span class="p">,</span>
                                                      <span class="s">&quot;country&quot;</span> <span class="p">:</span> <span class="s">&quot;Switzerland&quot;</span><span class="p">,</span>
                                                      <span class="s">&quot;email&quot;</span> <span class="p">:</span> <span class="s">&quot;info@supsi.ch&quot;</span><span class="p">,</span>
                                                      <span class="p">}</span>
                                     <span class="p">}</span>
                 <span class="p">}</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div> 
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="test.html" title="Testing"
             >next</a> |</li>
        <li class="right" >
          <a href="how_it_work.html" title="How it works"
             >previous</a> |</li>
        <li><a href="../index.html">home</a>|&nbsp;</li>
        <li><a href="index.html">documentation </a> |&nbsp;</li>
        <li><a href="../download/index.html">download </a> |&nbsp;</li>
        <li><a href="../tutorial/index.html">tutorial </a> |&nbsp;</li>
        <li><a href="../search.html">search</a>|&nbsp;</li>
        <li><a href="../licence/index.html">licence </a> |&nbsp;</li>

          <li><a href="index.html" >Documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2010, Massimiliano Cannata.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.2.
    </div>
  </body>
</html>